(window["webpackJsonpPluginblur-elysium-slider"]=window["webpackJsonpPluginblur-elysium-slider"]||[]).push([[9196],{5726:function(){},9196:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return c}}),o(1663);let{Component:s,State:l,Mixin:i}=Shopware,n={viewports:{mobile:{colStart:"auto",colEnd:12,rowStart:"auto",rowEnd:"auto",order:null},tablet:{colStart:"auto",colEnd:6,rowStart:"auto",rowEnd:"auto",order:null},desktop:{colStart:"auto",colEnd:3,rowStart:"auto",rowEnd:"auto",order:null}}};var c=s.wrapComponentConfig({template:'<div class="blur-elysium-cms-section-wrapper">\n\n    <blur-elysium-cms-section-add-block \n        v-if="section.blocks.length === 0"\n        :key="0"\n        @click="onAddBlock"\n        v-droppable="{ dragGroup: \'cms-stage\', data: getDropData(0), onDrop: block => dropBlock(block, 0) }" />\n\n    <div :style="gridStyle"\n        ref="elysiumSectionGrid"\n        @dragover.prevent \n        @drop="onGridDrop">\n\n        <template\n            v-for="(block, index) in section.blocks"\n            :key="block.id">\n            \n            <sw-cms-block\n                ref="elysiumStageBlock"\n                :class="[\'sw-cms-stage-block\', \'blur-elysium-section-block\']"\n                :block="block"\n                :disabled="disabled"\n                :active="cmsPageState.selectedBlock !== null && cmsPageState.selectedBlock.id === block.id"\n                :has-errors="hasBlockErrors(block)"\n                :style="setBlockStyles(block)"\n                v-droppable="{ dragGroup: \'cms-stage\', data: getDropData(index + 1), onDrop: block => dropBlock(block, index + 1) }"\n                @block-overlay-click="onBlockSelection(block)">\n            \n\n                <div class="blur-elysium-section-block-dropper">\n                    <mt-icon name="regular-plus-circle" />\n                    Zum hinzuf\xfcgen hier platzieren\n                </div>\n\n                <div class="blur-elysium-section-block-resizer" \n                    draggable="true" \n                    @click="test"\n                    @dragstart="$event => startBlockResizeX($event, block, index)"\n                    @dragend="endBlockResizeX"\n                    @drag="dragBlockResizingX" />\n\n                <component\n                    :is="`sw-cms-block-${block.type}`"\n                    :block="block">\n                    \n\n                    <template\n                        v-for="el in block.slots"\n                        :key="el.id"\n                        #[el.slot]\n                    >\n                        <sw-cms-slot\n                            :element="el"\n                            :active="cmsPageState.selectedBlock !== null && cmsPageState.selectedBlock.id === block.id"\n                        />\n                    </template>\n\n                </component>\n\n            </sw-cms-block>\n\n        </template>\n\n    </div>\n</div>',props:["section"],inject:["cmsService"],mixins:[i.getByName("cms-state")],data(){return{draggedBlock:null,draggedBlockStartPosX:0,draggedBlockWidth:0}},watch:{"section.blocks.length":{handler(){this.section.blocks.map((e,t)=>{null===e.customFields?e.customFields={elysiumBlockSettings:structuredClone(n)}:e.customFields.hasOwnProperty("elysiumBlockSettings")||(e.customFields.elysiumBlockSettings=structuredClone(n))})}},$refs:{handler(){console.log("refs",this.$refs)},deep:!0}},computed:{cmsPageState(){return l.get("cmsPageState")},currentDevice(){return"tablet-landscape"===this.cmsPageState.currentCmsDeviceView?"tablet":this.cmsPageState.currentCmsDeviceView},gridStyle(){return console.log("gridStyle",this.getViewportSetting(this.section.customFields?.elysiumSectionSettings,"gridGap")),{display:"grid",gridTemplateColumns:"repeat(12, minmax(0, 1fr))",gap:`${this.getViewportSetting(this.section.customFields?.elysiumSectionSettings,"gridGap")}px`,paddingBlock:`${this.getViewportSetting(this.section.customFields?.elysiumSectionSettings,"paddingY")}px`,paddingInline:`${this.getViewportSetting(this.section.customFields?.elysiumSectionSettings,"paddingX")}px`,alignItems:this.getViewportSetting(this.section.customFields?.elysiumSectionSettings,"alignItems")}}},methods:{getDropData(e,t="main"){return{dropIndex:e,section:this.section,sectionPosition:t}},dropBlock(e,t){this.section.blocks[t].hasOwnProperty("customFields")?this.section.blocks[t].customFields.elysiumBlockSettings=structuredClone(n):this.section.blocks[t].customFields={elysiumBlockSettings:structuredClone(n)},console.log("dropBlock",t,this.section.blocks[t],e)},setBlockStyles(e){let t={};return e.customFields&&e.customFields.elysiumBlockSettings?.viewports&&(t["--blur-elysium-section-block-col-start"]=this.getViewportSetting(e.customFields.elysiumBlockSettings,"colStart"),t["--blur-elysium-section-block-col-end"]=this.getViewportSetting(e.customFields.elysiumBlockSettings,"colEnd"),t["--blur-elysium-section-block-row-start"]=this.getViewportSetting(e.customFields.elysiumBlockSettings,"rowStart"),t["--blur-elysium-section-block-row-end"]=this.getViewportSetting(e.customFields.elysiumBlockSettings,"rowEnd")),t},hasBlockErrors(e){return[this.hasUniqueBlockErrors(e),this.hasSlotConfigErrors(e)].some(e=>!!e)},hasUniqueBlockErrors(e){let t=this.pageSlotsError?.parameters?.elements;return!!t&&t.some(t=>t.blockIds.includes(e.id))},hasSlotConfigErrors(e){let t=this.pageSlotConfigError?.parameters?.elements;return!!t&&t.some(t=>t.blockId===e.id)},onBlockSelection(e){Shopware.Store.get("cmsPageState").setBlock(e),this.$emit("page-config-open","itemConfig")},onGridDrop(e){this.draggedBlock.customFields.elysiumBlockSettings.viewports[this.currentDevice].colEnd=this.calculateDraggedBlockColWidth(e.x)},startBlockResizeX(e,t,o){this.draggedBlock=t,this.draggedBlockStartPosX=e.x,this.draggedBlockWidth=e.target.offsetParent.offsetWidth;let s=new Image;s.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",e.dataTransfer.setDragImage(s,0,0)},endBlockResizeX(e){this.calculateDraggedBlockColWidth(e.x)>=12&&(this.draggedBlock.customFields.elysiumBlockSettings.viewports[this.currentDevice].colEnd=12)},dragBlockResizingX(e){this.calculateDraggedBlockColWidth(e.x)>0&&12>=this.calculateDraggedBlockColWidth(e.x)&&(this.draggedBlock.customFields.elysiumBlockSettings.viewports[this.currentDevice].colEnd=this.calculateDraggedBlockColWidth(e.x))},calculateDraggedBlockColWidth(e){return Math.round((this.draggedBlockWidth+(e-this.draggedBlockStartPosX))/(this.$refs.elysiumSectionGrid.offsetWidth/12))},getViewportSetting(e,t){return e?.viewports[this.currentDevice][t]??null},onAddBlock(){this.$emit("on-add-block")}},created(){console.log(this.section)}})},1663:function(e,t,o){var s=o(5726);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals),o(5346).Z("1adfd2e4",s,!0,{})}}]);