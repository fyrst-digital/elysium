"use strict";(window["webpackJsonpPluginblur-elysium-slider"]=window["webpackJsonpPluginblur-elysium-slider"]||[]).push([[5647],{5647:function(e,i,t){t.r(i),t.d(i,{default:function(){return g}});let{Utils:s}=Shopware,n={slide:{paddingX:null,paddingY:null,borderRadius:null,alignItems:null,justifyContent:null},container:{paddingX:null,paddingY:null,borderRadius:null,maxWidth:null,gap:null,justifyContent:null,alignItems:null,columnWrap:!0,order:null},content:{paddingX:null,paddingY:null,maxWidth:null,textAlign:null},image:{justifyContent:null,maxWidth:null,imageFullWidth:!1},coverMedia:{objectPosX:null,objectPosY:null,objectFit:null},headline:{fontSize:20},description:{fontSize:14}};function l(e){return s.object.deepMergeObject(structuredClone(n),e)}var a={slide:{headline:{color:"",element:"div"},description:{color:null},linking:{type:"custom",buttonAppearance:"primary",buttonSize:"md",openExternal:!1,overlay:!1,showProductFocusImage:!0},bgColor:"",bgGradient:{startColor:"",endColor:"",gradientType:"linear-gradient",gradientDeg:45},cssClass:null},container:{bgColor:"",bgEffect:{blur:"8px"}},viewports:{mobile:l(),tablet:l({container:{columnWrap:!1},headline:{fontSize:32},description:{fontSize:16}}),desktop:l({container:{columnWrap:!1},headline:{fontSize:40},description:{fontSize:20}})},slideTemplate:"default",customTemplateFile:null};let{Component:d,State:r,Context:o,Mixin:u,Data:c,Utils:m,Store:h}=Shopware,{Criteria:p}=c;var g=d.wrapComponentConfig({template:'<sw-page>\n\n    <template #smart-bar-header>\n        <h2>\n            {{ metaTitle }}\n        </h2>\n    </template>\n\n    <template #language-switch>\n\n        <sw-language-switch\n            :save-changes-function="saveOnLanguageChange"\n            :abort-change-function="abortOnLanguageChange"\n            :disabled="newSlide === true"\n            @on-change="onChangeLanguage"\n        />\n    </template>\n\n    <template #smart-bar-actions>\n\n        <sw-button\n            :disabled="(newSlide !== true && !hasChanges)"\n            v-tooltip="{\n                message: cancelActionMessage\n            }"\n            @click="cancelAction">\n            {{ $tc(\'sw-customer.detail.buttonCancel\') }}\n        </sw-button>\n\n        <sw-button-group\n            :split-button="true">\n\n            <sw-button-process\n                :is-loading="isLoading"\n                :disabled="!(permissionCreate || permissionEdit)"\n                variant="primary"\n                @click.prevent="saveSlide"\n            >\n                {{ $tc(\'sw-customer.detail.buttonSave\') }}\n            </sw-button-process>\n\n            <sw-context-button\n                v-if="newSlide !== true">\n\n                <template #button>\n                    <sw-button\n                        square\n                        variant="primary"\n                        :disabled="isLoading"\n                    >\n                        <blur-icon\n                            name="blurph-caret-down-bold"\n                            size="24"\n                        />\n                    </sw-button>\n                </template>\n\n                <sw-context-menu-item\n                    :disabled="!permissionCreate"\n                    @click="onCopySlide">\n                    {{ $tc(\'blurElysiumSlides.actions.copySlide\') }}\n                </sw-context-menu-item>\n\n                <sw-context-menu-item\n                    variant="danger"\n                    :disabled="!permissionDelete"\n                    @click="permissionDelete === true ? showDeleteModal = true : null">\n                    {{ $tc(\'blurElysiumSlides.actions.deleteSlide\') }}\n                </sw-context-menu-item>\n\n            </sw-context-button>\n\n        </sw-button-group>\n    </template>\n\n    <template #content>\n\n        <div v-if="slide"\n            :style="viewStyle({ \n                mobile: { \'padding\': \'16px\' } \n            })">\n\n            <sw-tabs\n                position-identifier="positionIdentifiers.placeholder">\n\n                <sw-tabs-item\n                    :route="contentRoute"\n                    :title="$tc(\'blurElysiumSlides.settings.baseLabel\')"\n                    :hasError="tabContentHasError">\n                    {{ $tc(\'blurElysiumSlides.settings.baseLabel\') }}\n                </sw-tabs-item>\n\n                <sw-tabs-item\n                    :route="mediaRoute"\n                    :title="$tc(\'blurElysiumSlides.settings.mediaLabel\')">\n                    {{ $tc(\'blurElysiumSlides.settings.mediaLabel\') }}\n                </sw-tabs-item>\n\n                <sw-tabs-item\n                    :route="displayRoute"\n                    :title="$tc(\'blurElysium.general.appearance\')">\n                    {{ $tc(\'blurElysium.general.appearance\') }}\n                </sw-tabs-item>\n\n                <sw-tabs-item\n                    :route="advancedRoute"\n                    :title="$tc(\'blurElysiumSlides.settings.advancedLabel\')"\n                    :hasWarning="tabAdvancedHasWarning"\n                    :warningTooltip="tabAdvancedWarningMessage">\n                    {{ $tc(\'blurElysiumSlides.settings.advancedLabel\') }}\n                </sw-tabs-item>\n\n                <template #content>\n                    <router-view />\n                </template>\n            </sw-tabs>        \n        </div>\n\n        <sw-confirm-modal \n            v-if="showDeleteModal === true" \n            type="delete"\n            :title="$tc(\'blurElysiumSlides.actions.deleteSlide\')"\n            :text="$tc(\'blurElysiumSlides.messages.slideDeleteConfirm\')"\n            @confirm="deleteSlide"\n            @cancel="showDeleteModal = false"\n            @close="showDeleteModal = false" />\n\n    </template>\n\n</sw-page>',inject:["repositoryFactory","acl"],mixins:[u.getByName("placeholder"),u.getByName("notification"),u.getByName("blur-style-utilities")],props:{newSlide:{type:Boolean,required:!0,default:!1},slideId:{type:String,required:!1,default:null}},watch:{newSlide(e){!0===e&&this.createSlide()},slideId(){this.loadSlide()},slide:{handler:function(e){this.hasChanges=this.slidesRepository.hasChanges(e)},deep:!0}},metaInfo(){return{title:this.$createTitle(this.metaTitle)}},data(){return{defaultSlideSettings:structuredClone(a),showDeleteModal:!1,isLoading:!0,isSaved:!1,hasChanges:!1}},computed:{elysiumUI(){return h.get("elysiumUI")},elysiumSlide(){return h.get("elysiumSlide")},device(){return h.get("elysiumUI").device},slide(){return this.elysiumSlide.slide},contentRoute(){return!1===this.newSlide?{name:"blur.elysium.slides.detail.content",params:{id:this.slideId}}:{name:"blur.elysium.slides.create.content"}},mediaRoute(){return!1===this.newSlide?{name:"blur.elysium.slides.detail.media",params:{id:this.slideId}}:{name:"blur.elysium.slides.create.media"}},displayRoute(){return!1===this.newSlide?{name:"blur.elysium.slides.detail.display",params:{id:this.slideId}}:{name:"blur.elysium.slides.create.display"}},advancedRoute(){return!1===this.newSlide?{name:"blur.elysium.slides.detail.advanced",params:{id:this.slideId}}:{name:"blur.elysium.slides.create.advanced"}},slidesRepository(){return this.repositoryFactory.create("blur_elysium_slides")},customFieldSetRepository(){return this.repositoryFactory.create("custom_field_set")},cancelActionMessage(){return!0===this.newSlide?this.$tc("blurElysiumSlides.messages.cancelSlideCreation"):this.$tc("blurElysiumSlides.messages.cancelSlideChanges")},metaTitle(){return this.placeholder(this.slide,"name",this.$tc("blurElysiumSlides.actions.newSlide"))},permissionView(){return this.acl.can("blur_elysium_slides.viewer")},permissionCreate(){return this.acl.can("blur_elysium_slides.creator")},permissionEdit(){return this.acl.can("blur_elysium_slides.editor")},permissionDelete(){return this.acl.can("blur_elysium_slides.deleter")},tabContentHasError(){return"product"===this.slide.slideSettings.slide.linking.type&&(void 0===this.slide.productId||null===this.slide.productId||""===this.slide.productId)},tabAdvancedHasWarning(){return!!this.slide.slideSettings.customTemplateFile},tabAdvancedWarningMessage(){return this.$t("blurElysiumSlides.messages.customTemplateFileDefinedNotice")}},methods:{setMediaSidebar(e){this.elysiumUI.setMediaSidebar(e)},createSlide(){r.commit("context/resetLanguageToDefault");let e=this.slidesRepository.create(o.api);Object.assign(e,{slideSettings:this.defaultSlideSettings}),this.slide=e,this.isLoading=!1},deleteSlide(){this.isLoading=!0,this.slidesRepository.delete(this.slideId,o.api).then(()=>{this.$emit("delete-finish"),this.$router.push({name:"blur.elysium.slides.overview"})}).catch(e=>{console.error(e)})},loadSlide(){this.slidesRepository.get(this.slideId,o.api,new p).then(e=>{let i=m.object.deepMergeObject(this.defaultSlideSettings,e.slideSettings);e.slideSettings=i,this.elysiumSlide.setSlide(e),this.loadCustomFieldSets()}).catch(e=>{console.warn(e)}).finally(()=>{this.isLoading=!1})},loadCustomFieldSets(){let e=new p;e.addFilter(p.equals("relations.entityName","blur_elysium_slides")),e.getAssociation("customFields").addSorting(p.sort("config.customFieldPosition")),this.customFieldSetRepository.search(e,o.api).then(e=>{this.elysiumSlide.setCustomFieldSet(e)}).catch(e=>{console.warn(e)})},overviewPush(){this.$router.push({name:"blur.elysium.slides.overview"})},detailPush(e){this.$router.push({name:"blur.elysium.slides.detail",params:{id:e}})},async saveSlide(){if(this.newSlide&&this.permissionCreate||this.permissionEdit){if(this.isLoading=!0,"product"===this.slide.slideSettings.slide.linking.type&&[void 0,null,""].includes(this.slide.productId)){this.createNotificationError({message:this.$t("blurElysiumSlides.messages.productLinkingMissingEntity")}),this.isLoading=!1;return}this.slidesRepository.save(this.slide).then(e=>{this.createNotificationSuccess({message:this.$t("blurElysiumSlides.messages.slideSavedSuccess",{slide:this.slide.name})}),!0===this.newSlide&&this.detailPush(JSON.parse(e.config.data).id),this.loadSlide()}).catch(e=>{void 0===this.slide.name||null===this.slide.name||""===this.slide.name?this.createNotificationError({title:this.$tc("blurElysiumSlides.messages.emptySlideNameErrorTitle"),message:this.$tc("blurElysiumSlides.messages.emptySlideNameError")}):this.createNotificationError({message:this.$tc("blurElysiumSlides.messages.slideSaveError")}),console.error(e),this.isLoading=!1})}},cancelAction(){!0===this.newSlide?this.overviewPush():this.$router.go(0)},saveOnLanguageChange(){this.saveSlide()},abortOnLanguageChange(){return this.slidesRepository.hasChanges(this.slide)},onChangeLanguage(e){r.commit("context/setApiLanguageId",e),this.slideId&&this.loadSlide()},onCopySlide(){if(!0!==this.permissionCreate)return;if(this.slidesRepository.hasChanges(this.slide)){this.createNotificationError({message:this.$tc("blurElysiumSlides.messages.copyErrorUnsavedChanges")});return}let e={overwrites:{name:`${this.slide.name}-${this.$tc("blurElysium.general.copySuffix")}`}};this.isLoading=!0,this.slidesRepository.clone(this.slide.id,e).then(e=>{this.$router.push({name:"blur.elysium.slides.detail",params:{id:e.id}})}).catch(e=>{console.warn(e)})}},created(){!0===this.newSlide?this.createSlide():this.loadSlide()}})}}]);