{"version":3,"file":"index-2WycJoQK.js","sources":["../../../app/administration/src/component/slides/form/cover/template.html.twig","../../../app/administration/src/component/slides/form/cover/index.ts"],"sourcesContent":["<mt-card\n    position-identifier=\"blurElysium.slide.form.cover\"\n    :title=\"$tc('blurElysiumSlides.forms.slideCover.label')\"\n    :class=\"['content-no-padding']\">\n\n    <template #headerRight>\n\n        <blur-device-switch \n            layout=\"row\"\n            show-label=\"false\"\n            :default-viewport=\"device\"\n            :style=\"{\n                padding: '0',\n                width: '100%',\n                justifyContent: 'center',\n                '--container-gap': '12px',\n                '--icon-padding': '6px',\n                '--icon-bg-color': '#ffffff',\n                '--icon-hover-bg-color': 'var(--color-gray-100)',\n            }\" \n            :device=\"device\"\n            @change-device=\"device => elysiumUI.setDevice(device)\"\n            />\n    </template>\n\n    <template #tabs>\n        <mt-tabs \n            :defaultItem=\"activeTab\"\n            :items=\"tabs\"\n            @new-item-active=\"activeTab = $event\"\n        />\n    </template>\n\n    <blur-section>\n\n        <blur-column\n            padding\n            :cols-tablet=\"6\"\n            :cols-desktop=\"8\"\n            :style=\"viewStyle({\n                mobile:  { position: 'relative' },\n                desktop: { borderRight: '1px solid var(--color-border-primary-default)' }\n            })\">\n\n\n            <mt-loader v-if=\"mediaLoading\" />\n\n            <template v-if=\"activeTab === 'coverImage'\">\n\n                <blur-section\n                    gap-y\n                    :description=\"$tc('blurElysiumSlides.forms.slideCoverImage.description')\">\n    \n                    <blur-column>\n\n                        <sw-upload-listener\n                            :upload-tag=\"slideCoverUploadTag\"\n                            auto-upload\n                            @media-upload-finish=\"setSlideCover\"\n                        />\n                        <sw-media-upload-v2\n                            variant=\"regular\"\n                            label=\"Medium\"\n                            :disabled=\"!(permissionCreate || permissionEdit)\"\n                            file-accept=\"image/*\"\n                            :upload-tag=\"slideCoverUploadTag\"\n                            :source=\"slideCover\"\n                            :allow-multi-select=\"false\"\n                            :default-folder=\"'blur_elysium_slides'\"\n                            @media-upload-remove-image=\"removeSlideCover\"\n                            @media-upload-sidebar-open=\"openMediaModal\"\n                        />\n                    </blur-column>\n\n                </blur-section>\n            </template>\n\n            <template v-if=\"activeTab === 'coverVideo'\">\n\n                <blur-section\n                    gap-y\n                    :description=\"$tc('blurElysiumSlides.forms.slideCoverVideo.description')\"\n                    >\n\n                    <blur-column>  \n\n                            <sw-upload-listener\n                                upload-tag=\"blur-elysium-slide-cover-video\"\n                                auto-upload\n                                @media-upload-finish=\"payload => setSlideCover(payload, true)\"\n                            />\n                            <sw-media-upload-v2\n                                ref=\"coverVideoUploadElement\"\n                                variant=\"regular\"\n                                label=\"Medium\"\n                                :disabled=\"!(permissionCreate || permissionEdit)\"\n                                file-accept=\"video/*\"\n                                upload-tag=\"blur-elysium-slide-cover-video\"\n                                :source=\"slideCoverVideo\"\n                                :allow-multi-select=\"false\"\n                                :default-folder=\"'blur_elysium_slides'\"\n                                @media-upload-remove-image=\"removeSlideCover(true)\"\n                                @media-upload-sidebar-open=\"openMediaModal('slideCoverVideo')\"\n                            />\n                    </blur-column>\n\n                </blur-section>\n            </template>\n        </blur-column>\n\n        <blur-column\n            padding\n            :cols-tablet=\"6\"\n            :cols-desktop=\"4\">\n\n            <blur-section\n                gap-y>\n\n                <blur-column>\n                    <blur-select-input \n                        :label=\"$tc('blurElysium.general.objectPosY')\" \n                        :placeholder=\"viewportsPlaceholder('coverMedia.objectPosY', 'center', 'blurElysium.general')\"\n                        :device=\"device\"\n                        :show-device=\"true\"\n                        :options=\"[\n                            { value: 'top', label: $tc('blurElysium.general.top') },\n                            { value: 'center', label: $tc('blurElysium.general.center') },\n                            { value: 'bottom', label: $tc('blurElysium.general.bottom') }\n                        ]\"\n                        @on-device=\"deviceSwitch\"\n                        v-model:value=\"slideViewportSettings.coverMedia.objectPosY\" />\n                </blur-column>\n\n                <blur-column>\n                    <blur-select-input\n                        :label=\"$tc('blurElysium.general.objectPosX')\" \n                        :placeholder=\"viewportsPlaceholder('coverMedia.objectPosX', 'center', 'blurElysium.general')\"\n                        :device=\"device\"\n                        :show-device=\"true\"\n                        :options=\"[\n                            { value: 'left', label: $tc('blurElysium.general.left') },\n                            { value: 'center', label: $tc('blurElysium.general.center') },\n                            { value: 'right', label: $tc('blurElysium.general.right') }\n                        ]\"\n                        @on-device=\"deviceSwitch\"\n                        v-model:value=\"slideViewportSettings.coverMedia.objectPosX\" />\n                </blur-column>\n\n                <blur-column>\n                    <blur-select-input \n                        :label=\"$tc('blurElysium.general.objectFit')\" \n                        :placeholder=\"viewportsPlaceholder('coverMedia.objectFit', 'cover', 'blurElysium.general')\"\n                        :device=\"device\"\n                        :show-device=\"true\"\n                        :options=\"[\n                            { value: 'cover', label: $tc('blurElysium.general.cover') },\n                            { value: 'contain', label: $tc('blurElysium.general.contain') },\n                            { value: 'auto', label: $tc('blurElysium.general.auto') }\n                        ]\"\n                        @on-device=\"deviceSwitch\"\n                        v-model:value=\"slideViewportSettings.coverMedia.objectFit\" />\n                </blur-column>\n\n            </blur-section>\n        </blur-column>\n\n    </blur-section>\n\n    <sw-media-modal-v2\n        v-if=\"mediaModal.open\"\n        :allow-multi-select=\"false\"\n        entity-context=\"blur_elysium_slides\"\n        @media-modal-selection-change=\"onAddMediaModal\"\n        @modal-close=\"closeMediaModal\" \n    />\n\n</mt-card>","import slide from '../slide'\nimport template from './template.html.twig'\n\nconst { Component, Mixin, Store, Context } = Shopware \n\nexport default Component.wrapComponentConfig({\n    template,\n\n    mixins: [\n        Mixin.getByName('notification'),\n        Mixin.getByName('blur-device-utilities'),\n        Mixin.getByName('blur-style-utilities')\n    ],\n\n    inject: [\n        'repositoryFactory',\n        'acl'\n    ],\n\n    data () {\n        return {\n            activeTab: 'coverImage',\n            slideCoverMapping: {\n                mobile: 'slideCoverMobile',\n                tablet: 'slideCoverTablet',\n                desktop: 'slideCover'\n            },\n            mediaLoading: false,\n            mediaModal: {\n                open: false,\n                type: null\n            }\n        }\n    },\n\n    computed: {\n\n        elysiumUI () {\n            return Store.get('elysiumUI')\n        },\n\n        slide () {\n            return Store.get('elysiumSlide').slide\n        },\n\n        device () {\n            return this.elysiumUI.device\n        },\n\n        mediaSidebar () {\n            return this.elysiumUI.mediaSidebar\n        },\n\n        mediaRepository () {\n            return this.repositoryFactory.create('media')\n        },\n\n        slideViewportSettings () {\n            return this.slide.slideSettings.viewports[this.device]\n        },\n\n        tabs () {\n            return [\n                {\n                    label: this.$tc('blurElysiumSlides.forms.slideCoverImage.label'),\n                    name: 'coverImage',\n                },\n                {\n                    label: this.$tc('blurElysiumSlides.forms.slideCoverVideo.label'),\n                    name: 'coverVideo',\n                },\n            ]\n        },\n\n        slideCoverUploadTag () {\n            const uploadTag = {\n                mobile: 'blur-elysium-slide-cover-mobile',\n                tablet: 'blur-elysium-slide-cover-tablet',\n                desktop: 'blur-elysium-slide-cover'\n            }\n\n            return uploadTag[this.device]\n        },\n\n        slideCover () {\n            return this.slide[this.slideCoverMapping[this.device]] ?? null\n        },\n\n        slideCoverProp () {\n            return this.slideCoverMapping[this.device]\n        },\n\n        slideCoverVideo () {\n            return this.slide.slideCoverVideo ?? null\n        },\n\n        coverVideoUploadElement () {\n            return this.$refs.coverVideoUpload ?? null\n        },\n\n        permissionView() {\n            return this.acl.can('blur_elysium_slides.viewer')\n        },\n\n        permissionCreate() {\n            return this.acl.can('blur_elysium_slides.creator')\n        },\n\n        permissionEdit() {\n            return this.acl.can('blur_elysium_slides.editor')\n        },\n\n        permissionDelete() {\n            return this.acl.can('blur_elysium_slides.deleter')\n        },\n    },\n\n    methods: {\n\n        setSlideCover (media: any, isVideo: boolean = false) {\n            this.mediaLoading = true\n\n            let mediaId = media.id || media.targetId || null\n            let mediaProp = isVideo ===  true ? 'slideCoverVideo' : this.slideCoverProp\n\n            if (mediaId === null) {\n                // throw error message because mediaId is null\n                console.error('mediaId is null. Slide cover media can not be set.')\n                this.mediaLoading = false\n            } else {\n                // mediaId is provided handle media assignment\n                this.slide[`${mediaProp}Id`] = mediaId\n\n                if (media.path) {\n\n                    // The media already exists in the system no need to fetch it. Use the already existing media object\n                    this.slide[mediaProp] = media;\n                    this.mediaLoading = false\n                } else {\n\n                    // The media does not exist in the system. Fetch the media object from media repository\n                    this.mediaRepository.get(\n                        mediaId,\n                        Context.api\n                    ).then((media) => {\n                        this.slide[mediaProp] = media;\n                        this.mediaLoading = false\n                    }).catch((exception) => {\n                        console.error(exception)\n                        this.mediaLoading = false\n                    })\n                }\n            }\n        },\n\n        removeSlideCover (isVideo: boolean = false) {\n            let mediaProp = isVideo ===  true ? 'slideCoverVideo' : this.slideCoverProp\n            this.slide[`${mediaProp}Id`] = null;\n            this.slide[mediaProp] = null;\n        },\n\n        openMediaModal (type: string = 'slideCover') {\n            this.mediaModal.open = true\n            this.mediaModal.type = type\n        },\n\n        closeMediaModal () {\n            this.mediaModal.open = false\n            this.mediaModal.type = null\n        },\n\n        onAddMediaModal (payload) {\n            \n            if (payload.length > 0) {\n                if (this.mediaModal.type === 'slideCover') {\n                    this.setSlideCover(payload[0])\n                } else if (this.mediaModal.type === 'slideCoverVideo') {\n                    this.setSlideCover(payload[0], true)\n                }\n            }\n        }\n    },\n\n    created () {\n        this.viewportsSettings = this.slide.slideSettings.viewports\n    },\n})\n"],"names":["template","Component","Mixin","Store","Context","index","media","isVideo","mediaId","mediaProp","exception","type","payload"],"mappings":"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"}