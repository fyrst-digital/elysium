const{Utils:r}=Shopware,d={slide:{paddingX:null,paddingY:null,borderRadius:null,alignItems:null,justifyContent:null},container:{paddingX:null,paddingY:null,borderRadius:null,maxWidth:null,gap:null,justifyContent:null,alignItems:null,columnWrap:!0,order:null},content:{paddingX:null,paddingY:null,maxWidth:null,textAlign:null},image:{justifyContent:null,maxWidth:null,imageFullWidth:!1},coverMedia:{objectPosX:null,objectPosY:null,objectFit:null},headline:{fontSize:20},description:{fontSize:14}};function a(e){return r.object.deepMergeObject(structuredClone(d),e)}const o={slide:{headline:{color:"",element:"div"},description:{color:null},linking:{type:"custom",buttonAppearance:"primary",buttonSize:"md",openExternal:!1,overlay:!1,showProductFocusImage:!0},bgColor:"",bgGradient:{startColor:"",endColor:"",gradientType:"linear-gradient",gradientDeg:45},cssClass:null},container:{bgColor:"",bgEffect:{blur:"8px"}},viewports:{mobile:a(),tablet:a({container:{columnWrap:!1},headline:{fontSize:32},description:{fontSize:16}}),desktop:a({container:{columnWrap:!1},headline:{fontSize:40},description:{fontSize:20}})},slideTemplate:"default",customTemplateFile:null},u=`<sw-page> <template #smart-bar-header> <h2> {{ metaTitle }} </h2> </template> <template #language-switch> <sw-language-switch :save-changes-function="saveOnLanguageChange" :abort-change-function="abortOnLanguageChange" :disabled="newSlide === true" @on-change="onChangeLanguage" /> </template> <template #smart-bar-actions> <mt-button :disabled="(newSlide !== true && !hasChanges)" v-tooltip="{ message: cancelActionMessage }" variant="secondary" size="default" @click="cancelAction"> {{ $tc('blurElysium.action.cancel') }} </mt-button> <sw-button-group :split-button="true"> <sw-button-process :is-loading="isLoading" :disabled="!(permissionCreate || permissionEdit)" variant="primary" @click.prevent="saveSlide" > {{ $tc('sw-customer.detail.buttonSave') }} </sw-button-process> <sw-context-button v-if="newSlide !== true"> <template #button> <sw-button square variant="primary" :disabled="isLoading" > <blur-icon name="blurph-caret-down-bold" size="16" /> </sw-button> </template> <sw-context-menu-item :disabled="!permissionCreate" @click="onCopySlide"> {{ $tc('blurElysiumSlides.actions.copySlide') }} </sw-context-menu-item> <sw-context-menu-item variant="danger" :disabled="!permissionDelete" @click="permissionDelete === true ? showDeleteModal = true : null"> {{ $tc('blurElysiumSlides.actions.deleteSlide') }} </sw-context-menu-item> </sw-context-button> </sw-button-group> </template> <template #content> <div v-if="slide" :style="viewStyle({ mobile: { 'padding': '16px' } })"> <sw-tabs position-identifier="positionIdentifiers.placeholder"> <sw-tabs-item :route="contentRoute" :title="$tc('blurElysiumSlides.settings.baseLabel')" :hasError="tabContentHasError"> {{ $tc('blurElysiumSlides.settings.baseLabel') }} </sw-tabs-item> <sw-tabs-item :route="mediaRoute" :title="$tc('blurElysiumSlides.settings.mediaLabel')"> {{ $tc('blurElysiumSlides.settings.mediaLabel') }} </sw-tabs-item> <sw-tabs-item :route="displayRoute" :title="$tc('blurElysium.general.appearance')"> {{ $tc('blurElysium.general.appearance') }} </sw-tabs-item> <sw-tabs-item :route="advancedRoute" :title="$tc('blurElysiumSlides.settings.advancedLabel')" :hasWarning="tabAdvancedHasWarning" :warningTooltip="tabAdvancedWarningMessage"> {{ $tc('blurElysiumSlides.settings.advancedLabel') }} </sw-tabs-item> <template #content> <router-view /> </template> </sw-tabs> </div> <sw-confirm-modal v-if="showDeleteModal === true" type="delete" :title="$tc('blurElysiumSlides.actions.deleteSlide')" :text="$tc('blurElysiumSlides.messages.slideDeleteConfirm')" @confirm="deleteSlide" @cancel="showDeleteModal = false" @close="showDeleteModal = false" /> </template> </sw-page>`,{Component:c,Context:i,Mixin:n,Data:m,Utils:h,Store:s}=Shopware,{Criteria:l}=m,g=c.wrapComponentConfig({template:u,inject:["repositoryFactory","acl"],mixins:[n.getByName("placeholder"),n.getByName("notification"),n.getByName("blur-style-utilities")],props:{newSlide:{type:Boolean,required:!0,default:!1},slideId:{type:String,required:!1,default:null}},watch:{newSlide(e){e===!0&&this.createSlide()},slideId(){this.loadSlide()},slide:{handler:function(e){this.hasChanges=this.slidesRepository.hasChanges(e)},deep:!0}},metaInfo(){return{title:this.$createTitle(this.metaTitle)}},data(){return{defaultSlideSettings:structuredClone(o),showDeleteModal:!1,isLoading:!0,isSaved:!1,hasChanges:!1}},computed:{context(){return s.get("context")},elysiumUI(){return s.get("elysiumUI")},elysiumSlide(){return s.get("elysiumSlide")},device(){return s.get("elysiumUI").device},slide(){return this.elysiumSlide.slide},contentRoute(){return this.newSlide===!1?{name:"blur.elysium.slides.detail.content",params:{id:this.slideId}}:{name:"blur.elysium.slides.create.content"}},mediaRoute(){return this.newSlide===!1?{name:"blur.elysium.slides.detail.media",params:{id:this.slideId}}:{name:"blur.elysium.slides.create.media"}},displayRoute(){return this.newSlide===!1?{name:"blur.elysium.slides.detail.display",params:{id:this.slideId}}:{name:"blur.elysium.slides.create.display"}},advancedRoute(){return this.newSlide===!1?{name:"blur.elysium.slides.detail.advanced",params:{id:this.slideId}}:{name:"blur.elysium.slides.create.advanced"}},slidesRepository(){return this.repositoryFactory.create("blur_elysium_slides")},customFieldSetRepository(){return this.repositoryFactory.create("custom_field_set")},cancelActionMessage(){return this.newSlide===!0?this.$tc("blurElysiumSlides.messages.cancelSlideCreation"):this.$tc("blurElysiumSlides.messages.cancelSlideChanges")},metaTitle(){return this.placeholder(this.slide,"name",this.$tc("blurElysiumSlides.actions.newSlide"))},permissionView(){return this.acl.can("blur_elysium_slides.viewer")},permissionCreate(){return this.acl.can("blur_elysium_slides.creator")},permissionEdit(){return this.acl.can("blur_elysium_slides.editor")},permissionDelete(){return this.acl.can("blur_elysium_slides.deleter")},tabContentHasError(){return this.slide.slideSettings.slide.linking.type==="product"&&(this.slide.productId===void 0||this.slide.productId===null||this.slide.productId==="")},tabAdvancedHasWarning(){return!!this.slide.slideSettings.customTemplateFile},tabAdvancedWarningMessage(){return this.$t("blurElysiumSlides.messages.customTemplateFileDefinedNotice")}},methods:{setMediaSidebar(e){this.elysiumUI.setMediaSidebar(e)},createSlide(){this.context.resetLanguageToDefault();const e=this.slidesRepository.create(i.api);Object.assign(e,{slideSettings:this.defaultSlideSettings}),this.elysiumSlide.setSlide(e),this.isLoading=!1},deleteSlide(){this.isLoading=!0,this.slidesRepository.delete(this.slideId,i.api).then(()=>{this.$emit("delete-finish"),this.$router.push({name:"blur.elysium.slides.overview"})}).catch(e=>{console.error(e)})},loadSlide(){this.slidesRepository.get(this.slideId,i.api,new l).then(e=>{const t=h.object.deepMergeObject(this.defaultSlideSettings,e.slideSettings);e.slideSettings=t,this.elysiumSlide.setSlide(e),this.loadCustomFieldSets()}).catch(e=>{console.warn(e)}).finally(()=>{this.isLoading=!1})},loadCustomFieldSets(){const e=new l;e.addFilter(l.equals("relations.entityName","blur_elysium_slides")),e.getAssociation("customFields").addSorting(l.sort("config.customFieldPosition")),this.customFieldSetRepository.search(e,i.api).then(t=>{this.elysiumSlide.setCustomFieldSet(t)}).catch(t=>{console.warn(t)})},overviewPush(){this.$router.push({name:"blur.elysium.slides.overview"})},detailPush(e){this.$router.push({name:"blur.elysium.slides.detail",params:{id:e}})},async saveSlide(){if(this.newSlide&&this.permissionCreate||this.permissionEdit){if(this.isLoading=!0,this.slide.slideSettings.slide.linking.type==="product"&&[void 0,null,""].includes(this.slide.productId)){this.createNotificationError({message:this.$t("blurElysiumSlides.messages.productLinkingMissingEntity")}),this.isLoading=!1;return}this.slidesRepository.save(this.slide).then(e=>{this.createNotificationSuccess({message:this.$t("blurElysiumSlides.messages.slideSavedSuccess",{slide:this.slide.name})}),this.newSlide===!0&&this.detailPush(JSON.parse(e.config.data).id),this.loadSlide()}).catch(e=>{this.slide.name===void 0||this.slide.name===null||this.slide.name===""?this.createNotificationError({title:this.$tc("blurElysiumSlides.messages.emptySlideNameErrorTitle"),message:this.$tc("blurElysiumSlides.messages.emptySlideNameError")}):this.createNotificationError({message:this.$tc("blurElysiumSlides.messages.slideSaveError")}),console.error(e),this.isLoading=!1})}},cancelAction(){this.newSlide===!0?this.overviewPush():this.$router.go(0)},saveOnLanguageChange(){this.saveSlide()},abortOnLanguageChange(){return this.slidesRepository.hasChanges(this.slide)},onChangeLanguage(e){this.context.setApiLanguageId(e),this.slideId&&this.loadSlide()},onCopySlide(){if(this.permissionCreate!==!0)return;if(this.slidesRepository.hasChanges(this.slide)){this.createNotificationError({message:this.$tc("blurElysiumSlides.messages.copyErrorUnsavedChanges")});return}const e={overwrites:{name:`${this.slide.name}-${this.$tc("blurElysium.general.copySuffix")}`}};this.isLoading=!0,this.slidesRepository.clone(this.slide.id,e).then(t=>{this.$router.push({name:"blur.elysium.slides.detail",params:{id:t.id}})}).catch(t=>{console.warn(t)})}},created(){this.newSlide===!0?this.createSlide():this.loadSlide()},unmounted(){this.elysiumSlide.clearSlide(),this.elysiumSlide.clearCustomFieldSet(),this.elysiumUI.resetDevice()}});export{g as default};
//# sourceMappingURL=index-BUCYU87I.js.map
