{"version":3,"file":"index-p_d6XG9_.js","sources":["../../../app/administration/src/component/utilities/slide-selection/template.html.twig","../../../app/administration/src/component/utilities/slide-selection/index.ts"],"sourcesContent":["<div \n    :style=\"{\n        display: 'flex',\n        flexDirection: 'column',\n        gap: '24px',\n    }\">\n\n    <blur-elysium-slide-search \n        :selected-slides-ids=\"selectedSlidesIds\"\n        @slide-selected=\"selectSlide\" />\n\n    <div v-if=\"selectedSlides.length > 0\"\n        class=\"blur-elysium-slide-selection-results\">\n\n        <div class=\"blur-elysium-slide-selection-results-list\"\n            ref=\"selectionList\"\n            @drop=\"onDrop($event)\"\n            @dragend=\"dragEnd($event)\"\n            @dragover.prevent\n            @dragenter.prevent>\n\n            <blur-elysium-slide-selection-item \n                v-for=\"slide in selectedSlides\" \n                :key=\"slide.id\"\n                :slide=\"slide\"\n                draggable\n                @slide-loaded=\"slideLoaded\"\n                @start-drag=\"startDrag\"\n                @enter-drag=\"onDrag\"\n                @position-up=\"slidePositionUp\"\n                @position-down=\"slidePositionDown\"\n                @edit-slide=\"slideEdit\"\n                @remove-slide=\"slideRemove\"/>\n\n        </div>\n    </div>\n\n    <div v-if=\"isLoading && selectedSlidesIds.length > 0\"\n        :style=\"{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: '30px',\n        }\">\n        \n        <div v-for=\"placholder in selectedSlidesIds.length\"\n            :key=\"placholder\"\n            :style=\"{\n                minHeight: '114px',\n                position: 'relative',\n                borderRadius: '10px',\n                overflow: 'hidden',\n            }\">\n            <mt-loader size=\"24px\"/>\n        </div>\n    </div>\n\n    <mt-banner \n        v-if=\"selectedSlidesIds.length === 0\"\n        variant=\"info\">\n\n        <span v-html=\"$tc('blurElysiumSlides.slideSelection.listNoSelection')\" />\n    </mt-banner>\n\n</div>\n","import template from './template.html.twig'\nimport './style.scss'\nimport { watch } from 'vue'\n\nconst { Component, Data, Context } = Shopware \nconst { Criteria } = Data \n\nexport default Component.wrapComponentConfig({\n    template,\n\n    inject: [\n        'repositoryFactory'\n    ],\n\n    props: {\n        selectedSlidesIds: {\n            type: Array,\n            required: true,\n        }\n    },\n\n    data () {\n        return {\n            isLoading: true,\n            selectedSlides: {},\n            currentDragIndex: 0,\n            draggedSlide: null,\n            draggedSlideElement: null,\n            placeholderElement: document.createElement('div')\n        }\n    },\n\n    watch: {\n        selectedSlides: {\n            handler () {\n                /**\n                 * because this.selectedSlidesIds is an immutable prop we have to clear the array first\n                 * then we can add the ids from selectedSlides collection via push to the selected slides element config\n                 * @todo it's a little bit clunky but it works for now. maybe find a better solution in the future\n                */\n                this.selectedSlidesIds.length = 0\n                this.selectedSlidesIds.push(...this.selectedSlides.map((slide) => slide.id))\n            },\n            deep: false\n        }\n    },\n\n    computed: {\n        slidesRepository () {\n            return this.repositoryFactory.create('blur_elysium_slides')\n        },\n    },\n\n    mounted () {\n        this.placeholderElement.style.borderRadius = '12px'\n        this.placeholderElement.style.backgroundColor = '#eeeeee'\n    },\n\n    methods: {\n\n        initSlides () {\n            const criteria = new Criteria()\n            criteria.setIds(this.selectedSlidesIds)\n\n            this.slidesRepository.search(criteria, Context.api).then((result) => {\n\n                /**\n                 * filter the selected slides to remove orphaned selections\n                 * @todo check if the filter funtion is really needed. Because the selectedSlidesIds are already set in the criteria `criteria.setIds(this.selectedSlidesIds)`\n                 */\n                const filteredSlides = result.filter((slide) => this.selectedSlidesIds.includes(slide.id))\n                this.selectedSlides = filteredSlides\n\n                /**\n                 * if the filtered slides are empty, then clear all selected slides Ids\n                 * @todo if the filtered slides not empty, check them against the selectedSlidesIds\n                 */\n                if (filteredSlides.length <= 0) {\n                    this.selectedSlidesIds.length = 0\n                }\n\n                this.isLoading = false\n            }).catch((error) => {\n                console.error('Error loading slides', error)\n            })\n        },\n\n        selectSlide (slide) {\n            // call if slide is selected\n            // add slide to this.selectedSlidesIds if is not in collection\n            // remove slide from this.selectedSlidesIds if is in collection\n            const index = this.selectedSlidesIds.indexOf(slide.id)\n\n            switch (this.selectedSlidesIds.includes(slide.id)) {\n                case true:\n                    /** @action remove slide **/\n                    this.selectedSlides.remove(slide.id)\n                    break\n                default:\n                    /** @action add slide **/\n                    this.selectedSlides.add(slide)\n                    break\n            }\n        },\n\n        onDrop () {\n            this.selectedSlides.moveItem(this.selectedSlides.indexOf(this.draggedSlide), this.currentDragIndex)\n            this.draggedSlideElement.classList.remove('is-dragged')\n            this.placeholderElement.remove()\n        },\n\n        dragEnd (event) {\n            event.target.classList.remove('is-dragged')\n            this.placeholderElement.remove()\n        },\n\n        startDrag (slide, event, element) {\n            this.draggedSlide = slide\n            this.draggedSlideElement = element\n            this.placeholderElement.style.height = `${element.offsetHeight}px`\n        },\n\n        onDrag (slide, event, element) {\n            if (this.draggedSlide === slide) {\n                this.draggedSlideElement.classList.add('is-dragged')\n            }\n\n            if (this.currentDragIndex !== this.selectedSlides.indexOf(slide)) {\n                element.before(this.placeholderElement)\n            } else {\n                element.after(this.placeholderElement)\n            }\n            \n            this.currentDragIndex = this.selectedSlides.indexOf(slide)\n        },\n\n        slidePositionUp (slide) {\n            const currentIndex = this.selectedSlides.indexOf(slide)\n            if (currentIndex > 0) this.selectedSlides.moveItem(currentIndex, currentIndex - 1)\n        },\n\n        slidePositionDown (slide) {\n            const currentIndex = this.selectedSlides.indexOf(slide)\n            if (currentIndex < this.selectedSlides.length - 1) this.selectedSlides.moveItem(currentIndex, currentIndex + 1)\n        },\n\n        slideRemove (slide) {\n            this.selectedSlides.remove(slide.id)\n        },\n\n        slideEdit (slide) {\n            const route = this.$router.resolve({ name: 'blur.elysium.slides.detail', params: { id: slide.id } })\n            window.open(route.href, '_blank')\n        },\n\n        onCreateSlide () {\n            const route = this.$router.resolve({ name: 'blur.elysium.slides.create' })\n            window.open(route.href, '_blank')\n        },\n\n        onSlideOverview () {\n            const route = this.$router.resolve({ name: 'blur.elysium.slides.overview' })\n            window.open(route.href, '_blank')\n        },\n    },\n\n    created() {\n        this.initSlides()\n    },\n})\n"],"names":["template","Component","Data","Context","Criteria","index","slide","criteria","result","filteredSlides","error","event","element","currentIndex","route"],"mappings":"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"}