{% if selectorClass is not defined %}
    {% set selectorClass = '.blur-elysium-slide' %}
{% endif %}

{% if viewportConfig is not defined %}
    {% set viewportConfig = element.config.viewports.value %}
{% endif %}

{% if slideStyles is not defined %}
    {% set slslideStylesideData = null %}
{% endif %}

{% if slideCover is not defined %}
    {% set slideCover = null %}
{% endif %}

{% if slideCoverPortrait is not defined %}
    {% set slideCoverPortrait = null %}
{% endif %}

{% set headlineStyles = {
    '--color': slideData.slideSettings.headlineTextcolor
} %}

{% apply spaceless %}
<style id="style-{{ slideData.id }}" style="display:none !important; visibility:hidden !important;">
    {# general slide styles #}
    {% if slideStyles is not empty %}
        {{ selectorClass|raw }}[data-elysium-slide-id="{{ slideData.id }}"] {
            {% for prop, value in slideStyles|filter(v => v !== null) %}
                {{prop}}: {{value}}
            {% endfor %}
        }
    {% endif %}

    {# slide headline styles #}
    {% if headlineStyles is not empty %}
        {{ selectorClass|raw }}[data-elysium-slide-id="{{ slideData.id }}"] .blur-elysium-slide-headline {
            {% for prop, value in headlineStyles|filter(v => v !== null) %}
                {{prop}}: {{value}}
            {% endfor %}
        }
    {% endif %}

    {# viewport options #}
    {% for device, options in viewportConfig %}
        @media (min-width: {{ theme_config('breakpoint.' ~ viewportMapping[device])~'px' }}) {
            {{ selectorClass|raw }}[data-elysium-slide-id="{{ slideData.id }}"] {
                {% if options.aspectRatio.auto is not same as(true) %}
                    --aspect-ratio: {{options.aspectRatio.width}} / {{options.aspectRatio.height}};
                {% else %}
                    --aspect-ratio: auto;
                {% endif %}
            }
        }            
    {% endfor %}

    {# slide cover (default) #}
    {% if slideCover is not null %}
        {% if slideCover.thumbnails.elements and slideCover.mediaFolder.configuration.createThumbnails is same as(true) %}
            
            {# sort array by thumbnail width so that the media query order is correct #}
            {% for thumbnail in slideCover.thumbnails.elements|sort((a, b) => a.width <=> b.width ) %}
                @media screen {% if loop.first is same as(false) %} and (min-width: {{ thumbnail.width ~ 'px' }}){% endif %} {
                    {{ selectorClass|raw }}[data-elysium-slide-id="{{ slideData.id }}"] {
                        background-image: url( "{{ thumbnail.url }}" );
                    }
                }
            {% endfor %}
        {% else %}
            {# fallback if no thumbnails are available #}
            @media screen {
                {{ selectorClass|raw }}[data-elysium-slide-id="{{ slideData.id }}"] {
                    background-image: url( "{{ slideCover.url }}" );
                }
            }
        {% endif %}
    {% endif %}

    {# slide cover (portrait) #}
    {% if slideCoverPortrait is not null %}
        {% if slideCoverPortrait.thumbnails.elements and slideCoverPortrait.mediaFolder.configuration.createThumbnails is same as(true) %}
            
            {# sort array by thumbnail width so that the media query order is correct #}
            {% for thumbnail in slideCoverPortrait.thumbnails.elements|sort((a, b) => a.width <=> b.width ) %}
                @media screen and (orientation: portrait) {% if loop.first is same as(false) %} and (min-width: {{ thumbnail.width ~ 'px' }}){% endif %} {
                    {{ selectorClass|raw }}[data-elysium-slide-id="{{ slideData.id }}"] {
                        background-image: url( "{{ thumbnail.url }}" );
                    }
                }
            {% endfor %}
        {% else %}
            {# fallback if no thumbnails are available #}
            @media screen and (orientation: portrait) {
                {{ selectorClass|raw }}[data-elysium-slide-id="{{ slideData.id }}"] {
                    background-image: url( "{{ slideCoverPortrait.url }}" );
                }
            }
        {% endif %}
    {% endif %}
</style>
{% endapply %}