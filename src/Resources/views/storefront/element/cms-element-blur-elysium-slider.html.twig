{% block cms_element_blur_elysium_slider_root %}
    {% set sliderAutoplay = element.translated.config.settings.value.autoplay %}
    {% set sliderNavigation = element.translated.config.navigation.value %}
    {% set sliderArrows = element.translated.config.arrows.value %}

    {% set sliderOptions = {
        splideOptions: {
            arrows: sliderArrows.active,
            pagination: sliderNavigation.active,
            mediaQuery: 'min',
            gap: '0px',
            autoplay: sliderAutoplay.active,
            interval: sliderAutoplay.interval,
            pauseOnHover: sliderAutoplay.pauseOnHover,
            speed: element.translated.config.settings.value.speed,
            rewind: element.translated.config.settings.value.rewind,
            breakpoints: {}
        }
    } %}

    {% set cmsSliderClasses = [
        'cms-element-elysium-slider'
    ] %}

    {% if element.config.settings.value.containerWidth is same as('content') %}
        {% set cmsSliderClasses = cmsSliderClasses|merge([
            'slide-container-boxed'
        ]) %}
    {% endif %}

    {% if element.config.settings.value.overlay is same as(true) %}
        {% set cmsSliderClasses = cmsSliderClasses|merge([
            'slide-overlay'
        ]) %}
    {% endif %}

    {# set breakpoint specific splide slider options #}
    {% set breakpointSliderOptions = {
        (theme_config('breakpoint.' ~ blurElysiumBreakpoints.mobile)): {
            perPage: element.config.settings.value.viewports.mobile.slidesPerPage ?? 1,
            gap: element.config.sizing.value.viewports.mobile.slidesGap ?? 0
        },
        (theme_config('breakpoint.' ~ blurElysiumBreakpoints.tablet)): {
            perPage: element.config.settings.value.viewports.tablet.slidesPerPage ?? 1,
            gap: element.config.sizing.value.viewports.tablet.slidesGap ?? 0
        },
        (theme_config('breakpoint.' ~ blurElysiumBreakpoints.desktop)): {
            perPage: element.config.settings.value.viewports.desktop.slidesPerPage ?? 1,
            gap: element.config.sizing.value.viewports.desktop.slidesGap ?? 0
        }
    } %}
    {% set sliderOptions = sliderOptions|merge({
        splideOptions: sliderOptions.splideOptions|merge({
            breakpoints: breakpointSliderOptions
        })
    }) %}

    {% block cms_element_blur_elysium_slider_css_styles %}
        {% sw_include '@Storefront/storefront/component/blur-elysium-slider/style.html.twig' %}
    {% endblock %}

    {% block cms_element_blur_elysium_slider %}
        {# your could override sliderSettings variables on this block #}

        <div id="elysiumSlider-{{ element.id }}" 
            data-blur-elysium-slider="{{sliderOptions|json_encode|replace({'%replace%': ''}) }}"
            class="{{cmsSliderClasses|join(' ')}}">

            {% block blur_elysium_control_include_header %} 
                {% if element.translated.config.content.value.title is not empty %} 
                    {% sw_include '@Storefront/storefront/component/blur-elysium-slider/header.html.twig' %}
                {% endif %}
            {% endblock %}

            {% if element.data.slideCollection is empty %}

                {% block cms_element_blur_elysium_slider_empty_state %}
                    <!-- no slide collection here -->
                {% endblock %}
            {% else %}

                {% block cms_element_blur_elysium_slider_container %}
                    <section class="blur-elysium-slider splide"
                        aria-label="Elysium Slider Title"
                        data-blur-elysium-slider-container>

                        {% block cms_element_blur_elysium_slide_wrapper %}
                            <div class="blur-elysium-slide__wrapper">

                                {% block cms_element_blur_elysium_slide_track_before %}{% endblock %}

                                <div class="splide__track">
                                    <ul class="splide__list">
                                        {% for slide in element.data.slideCollection %}
                                            <li class="cms-element-elysium-slide__wrapper splide__slide">

                                                {% block cms_element_blur_elysium_slide_include %}
                                                    {% set slideTemplate = 'default' %}
                                                    {% set slideFile = 'slide.html.twig' %}

                                                    {% if slide.slideSettings.customTemplateFile is not empty %}
                                                        {% set slideTemplate = 'custom' %}
                                                        {% set slideFile = slide.slideSettings.customTemplateFile ~ '.html.twig' %}
                                                    {% endif %}

                                                    {% sw_include '@Storefront/storefront/component/blur-elysium-slide/' ~ slideTemplate ~ '/' ~ slideFile ignore missing with {
                                                        slideData: slide
                                                    } %}
                                                {% endblock %}
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </div>

                                {% block cms_element_blur_elysium_slide_track_after %}

                                    {% block blur_elysium_slider_arrows_include_position_in_slider %}  
                                        {% sw_include '@Storefront/storefront/component/blur-elysium-slider/arrows.html.twig' with {
                                            config: sliderArrows,
                                            elementId: element.id
                                        } only %}
                                    {% endblock %}
                                {% endblock %}
                            </div>
                        {% endblock %}
                        
                        {% block blur_elysium_slider_navigation_include_under_slider %}  
                            {% sw_include '@Storefront/storefront/component/blur-elysium-slider/navigation.html.twig' with {
                                config: sliderNavigation,
                                elementId: element.id
                            } only %}
                        {% endblock %}

                    </section>
                {% endblock %} 
           {% endif %}

        </div>  
    {% endblock %}  
{% endblock %}
